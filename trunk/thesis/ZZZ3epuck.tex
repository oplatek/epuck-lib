%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                    %%%
%%% ©ablona bakaláøské práce na MFF UK %%%
%%%                                    %%%
%%% (c) Franti¹ek ©trupl, 2005         %%%
%%%                                    %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% POZOR: Úprava bakaláøské práce je závislá rovnì¾ na volbì jednostranného resp. oboustranného tisku.
%%%        Bli¾¹i informace naleznete v dokumentu Úprava bakaláøské práce, který se nalézá na adrese:
%%%        http://www.mff.cuni.cz/studium/obecne/bplayout/pok12mo4.pdf

\documentclass[12pt,notitlepage]{report}
%\pagestyle{headings}
\pagestyle{plain}

\frenchspacing % aktivuje pou¾ití nìkterých èeských typografických pravidel

\usepackage[latin2]{inputenc} % nastavuje pou¾ité kódování, u¾ivatelé Windows zamìní latin2 za cp1250
%\usepackage{czech}
\usepackage[czech]{babel}
\usepackage{a4wide} % nastavuje standardní evropský formát stránek A4
%\usepackage{index} % nutno pou¾ít v pøípadì tvorby rejstøíku balíèkem makeindex
%\usepackage{fancybox} % umo¾òuje pokroèilé rámeèkování :-)
\usepackage{graphicx} % nezbytné pro standardní vkládání obrázkù do dokumentu

\usepackage[left=4cm]{geometry} % nastavení dané velikosti okrajù

%\newindex{default}{idx}{ind}{Rejstøík} % zavádí rejstøík v pøípadì pou¾ití balíku index

\title{Object Oriented Library for Controlling an e-Puck Robot}   % tyto dvì polo¾ky jsou zde v podstatì formálnì, ve skuteènosti nejsou nikde 
\author{Ondøej Plátek} % dále v dokumentu pou¾ity

%\date{}

\begin{document}
\chapter{Chapter 3 E-Puck }
	\section{Chapter 3 overview }
		An object of interest of current thesis is e-Puck and how to program it.
		In this chapter is introduced e-Puck and its design from programmer's point of view.
		For each sensor is shortly presented its functions, acceptable values and typical usage. 
		After historical introduction the chapter continues with describing e-Puck 
		a mechanical design and stepper motors. E-Puck's motors are a great benefit of e-Puck.
		The chapter ends with describing a problematic using its camera.
	\section{Origin of e-Puck}
		E-Puck was developed in summer 2004 at the École Polytechnique Fédérale de Lausanne (EPFL) 
		as open tool. E-Puck designers used open software and hardware development model. 
		Motivation for a new robot arose from an absence of very small educational robot,
		which is sufficiently efficient, and can be used for education in many research areas.
		E-Puck can be applied in automatic control, signal processing or 
		distributed intelligent system research.
		Because of e-Puck is intended to be used by students, the structure is robust and simple to
		care about. Designers of e-Puck tried to use  as many manufacturing components as possible 
		in order to keep the price low.		 
		\\
		The first generation of e-Pucks was replaced by second stable generation from year 2006.
		So far more than 2000 robots has been manufactured.
		There are several distributors for Switzerland and America, one is in Japan.
		%todo literature needed 
		%http://www.roadnarrows.com/robotics/
		%http://www.aai.jp/
		%http://www.k-team.com/
		%http://www.cyberbotics.com/products/robots/e-puck.html
		%http://www.gctronic.com/
		%http://www.aai.ca/robots/e-puck.html
		Price of e-Puck should be between 450-550 euros.
	\section{Mechanical Design}
		The basic mechanical design consist of rounded transparent body, battery, two stepper motors with
		wheels on their axis, printed circuit board, plastic ring of LEDs, 
		a camera and default extension board.
		There are extension like floor sensors, rotating scanner or a turret with linear cameras,
		which can scale up e-Puck's sensors. If we are talking about e-Puck in present thesis,
		it is meant e-Puck only with default extension.
		\\
		With default extension robot is X mm %todo
		 heigh and has a diameter of 75 mm. 
		The battery is placed in the bottom and can be easily extract and recharged separately in charger.
		Two stepper motors with wheels are screwed to plastic body and are located on axis of e-Puck
		in order to allow robot turn around on place. Wheels has a diameter of 41 mm and the perch is 53 mm.
		Printed circuit board is fixed to the top of the body and around it is the LEDs' ring.
		A camera is on the front side of robot lying on the axis between wheels.
		The extension board covers the main printed circuit board.
		%todo a photo of e-Puck or e-Puck's mechanical structure needed
		\\
	\section{Sensors, actuators and heart of a robot}
		Sensors and actuators determine the possibility of robot usage.
		Luckily e-Puck has a lot sensors of different kinds and is equipped with typical actuators.
		The actuators consist of motors, 8 red LEDs on perimeter, 4 green body LEDs,
		 which are turned off and on together, a front LED and a speaker.
		 \\
		Stepper motors are great advantage of e-Puck, because the motion of wheel can be split
		into small steps. One wheel revolution corresponds to 1000 steps of motor. Because the 
		diameter of wheel is 41 mm, if the wheel makes revolution, the wheel goes 128.8 mm. 
		In conclusion thousand of steps match 128.8 mm and one step is 0.128 mm. 
		Motors are equipped with encoders and the motors are very accurate, 
		which with combination of simple odometry really helps in localization tasks.
		Nice feature of encoders is that, their value can be set at any time.
		Maximum speed of motors is one revolution per second in both directions.
		BTCom allows to programmer set the speed of motors and also get and set the values
		of encoders.
		\\ 
		All e-Puck LEDs can be used for debugging or for making robot visible to other devices.
		Furthermore front LED can be used to illuminate terrain before e-Puck.
		Each LED can be turn off, turn on or set to an inverse state, if it is used BTCom.
		\\
		Three axis accelerometer are placed inside the robots body. In rest position
		the accelerometer measure a slant of e-Puck. They can also measure acceleration of e-Puck
		and for example detect a collision or a falling state of e-Puck. There is no problem with
		using accelerometer via BTCom.
		\\
		Infra Red (IR) sensors are typical sensors for mobile robotics. E-Puck has eight of them.
		Four are located in front part of e-Puck, two are on both sides, two on back side.
		Sensors work in two modes. Firstly they measure ambient infra red light.
		In second mode IR sensors emit IR light and they measure reflected light, so 
		they can determine an obstacle, if it is near enough.
		Both functions are available in BTCom. 				
		Calibration of sensors increases the precision of detecting near obstacles.
		Infra red sensors are capable of recognising the obstacle under 4 cm.
		\\
		The Speaker together with microphones is a great communication tool between people and e-Puck.
		On the other hand limited processing power of e-Puck does not allow to store and
		 play complicated sounds. It is also impossible to use speaker with microphones to speech
		 recognition due to insufficient processing power.
		Despite the limitation of processing power the microphones can be easily use to locate
		the source of sound via amplitude measurement, because the microphones are placed near perimeter
		in triangle. Microphones measure a current amplitude of sound. As exact distances between microphones 
		are known, we can compute a frequency of sound using Fast Fourier Transformation (FFT).
		For computing FFT is suitable Digital Signal Processor (DSP),
		 which will be introduced onward in this chapter.
		Maximal acquisition speed is 33 kHz. 
		%todo literatue
		For more information see %todo  http://www.e-puck.org/index.php?option=com_content&task=view&id=34&Itemid=56
		\\
		Because a program, which uses BTCom, can capture values of amplitude only in big intervals, 
		it is not possible to compute frequency of sound by running FFT on Personal Computer. 
		However locate the source of sound is still possible.
		\\
		E-Puck's camera is colour CMOS camera with 640 * 480 resolution. 
		Because only 8 kB of RAM memory is available and part of it is used by running program,
		the picture size has to be reduced in order to save the image in memory.
		An image processing is really demanding on processing power so it is not 
		convenient to be ran on slow e-Puck's processor.
		\\
		On the other hand using BTCom solves the problem with limited processing power
		by sending picture to Personal Computer (PC). PC has enough resources to fast process the image,
		 but the transport of an image takes a really long time. 
		 For example capturing and sending a colour image of size 40 * 40 pixels 
		takes more than 0.2 seconds, if it is sent over Bluetooth.
		BTCom can set height, width, colour mode and zoom. If the picture is taken in grey scale mode,
		one pixel is save to one byte. In colour mode two pixels are needed.
		 Zoom has three acceptable values 1, 4 and 8. One is the biggest zoom, eight represents the smallest.
		Width and height are limited only by size of available memory in e-Puck.
		\\
		Processor, dsPIC 30F6014, is heart of e-Puck and it runs at 60 MHz, which correspond to 15 MIPS.
		It has C oriented instructions and supports compiling from GNU compilers.
		Except standard 16 bits core unit there is Digital Signal Processor,
		which brings very high performance for computation for example FFT or other signal processing.
		Programs can be downloaded to flash memory with 144 kB and
		 are loaded to RAM memory according to selector position.
		RAM memory has only 8 kB. In RAM memory is placed a currently running program and all its data.
		\\
		Communication with other devices is provided by Bluetooth and RS232 serial interface.
		Both, Bluetooth and RS232, can be used to download programs to e-Puck's flash memory.
		In addition Bluetooth can be used to communicate with other e-Pucks or with PC
		using BTCom. If the communication with PC uses BTCom program, its counter part
		at PC is connected to classical serial port.
\end{document}
				
